<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>epiworld: epiworld c++ template library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">epiworld
   &#160;<span id="projectnumber">0.0-1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">epiworld c++ template library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md13"></a>
Main features</h1>
<p>This C++ template-header-only library provides a general framework for epidemiologic simulation. The main features of the library are:</p>
<ol type="1">
<li>Four key classes: <code><a class="el" href="class_model.html" title="Core class of epiworld.">Model</a></code>, <code>Person</code>, <code><a class="el" href="class_tool.html" title="Tools for defending the agent against the virus.">Tool</a></code>, and <code><a class="el" href="class_virus.html" title="Virus.">Virus</a></code>.</li>
<li>The model features a social networks of <code>Persons</code>.</li>
<li><code>Persons</code> can have multiple <code><a class="el" href="class_tools.html" title="Set of tools (useful for building iterators)">Tools</a></code> as a defense system.</li>
<li><code><a class="el" href="class_tools.html" title="Set of tools (useful for building iterators)">Tools</a></code> can reduce contagion rate, transmissibility, death rates, and improve recovery rates.</li>
<li><code><a class="el" href="class_viruses.html" title="Set of viruses (useful for building iterators)">Viruses</a></code> can mutate (generating new variants).</li>
<li><code>Models</code> can feature multiple states, e.g., <code>HEALTHY</code>, <code>SUSCEPTIBLE</code>, etc.</li>
<li><code>Models</code> can have an arbitrary number of parameters.</li>
<li><b>REALLY FAST</b> About 6.5 Million person/day simulations per second.</li>
</ol>
<p><img src="/home/george/Documents/research/world-epi/contents.svg" alt="" style="pointer-events: none;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md14"></a>
Algorithm</h1>
<p>Setup</p>
<ul>
<li>Create viruses.</li>
<li>Create tools (arbitrary).</li>
<li>Set model parameters (arbitrary).</li>
<li>Create global events (e.g., surveillance).</li>
<li>Set up the population: small world network (default).</li>
<li>Set up rewiring (optional).</li>
<li>Set states (arbitrary number of them).</li>
</ul>
<p>Run</p>
<ol type="1">
<li>Distribute the tool(s) and virus(es)</li>
<li>For each t in 1 -&gt; Duration:<ul>
<li>Update state for susceptible/infected/removed(?)</li>
<li>Mutate virus(es) (each individual)</li>
<li>Run Global events (e.g., surveillance)</li>
<li>Run rewiring algorithm</li>
</ul>
</li>
</ol>
<p>Along update:</p>
<ul>
<li>Contagion events are applied recorded.</li>
<li>New variants are recorded.</li>
<li>Optional user data is recorded.</li>
</ul>
<h1><a class="anchor" id="autotoc_md15"></a>
Hello world (C++)</h1>
<div class="fragment"><div class="line">#include &quot;include/epiworld/epiworld.hpp&quot;</div>
<div class="line"> </div>
<div class="line">int main()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">  // Creating a virus</div>
<div class="line">  epiworld::Virus&lt;&gt; covid19(&quot;covid 19&quot;, .01, true);</div>
<div class="line">  covid19.set_infectiousness(.8);</div>
<div class="line">  </div>
<div class="line">  // Creating a tool</div>
<div class="line">  epiworld::Tool&lt;&gt; vax(&quot;vaccine&quot;, .5, true);</div>
<div class="line">  vax.set_contagion_reduction(.95);</div>
<div class="line"> </div>
<div class="line">  // Creating a model</div>
<div class="line">  epiworld::Model&lt;&gt; model;</div>
<div class="line"> </div>
<div class="line">  // Adding the tool and virus</div>
<div class="line">  model.add_virus(covid19);</div>
<div class="line">  model.add_tool(vax);</div>
<div class="line"> </div>
<div class="line">  // Generating a random pop</div>
<div class="line">  model.population_from_adjlist(</div>
<div class="line">    epiworld::rgraph_smallworld(1000, 5, .2)</div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  // Initializing setting days and seed</div>
<div class="line">  model.init(60, 123123);</div>
<div class="line"> </div>
<div class="line">  // Running the model</div>
<div class="line">  model.run();</div>
<div class="line"> </div>
<div class="line">  model.print();</div>
<div class="line"> </div>
<div class="line">  return;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Surveillance simulation</h1>
<ul>
<li>Incubation time of the disease <code>~ Gamma(3, 1)</code></li>
<li>Duration of the disease <code>~Gamma(12, 1)</code></li>
<li>Probability of becoming symptomatic: 0.9</li>
<li>Prob. of transmission: 1.0.</li>
<li>Vaccinated population: 25%</li>
<li>Vaccine efficacy: .9.</li>
<li>Vaccine reduction on transmission: 0.5.</li>
<li>Surveillance program of x% of the population at random.</li>
<li>Individuals who test positive become isolated.</li>
</ul>
<h2><a class="anchor" id="autotoc_md17"></a>
Preliminary results</h2>
<div class="fragment"><div class="line"># With low surveillance</div>
<div class="line">pop_size &lt;- 20e3</div>
<div class="line">pop_seed &lt;- pop_size * .01</div>
<div class="line">s_levels &lt;- c(0.0001, 0.002)</div>
<div class="line">system(sprintf(&quot;./07-surveillance.o %i %i 100 %.04f 2&gt;&amp;1&quot;, pop_seed, pop_size, s_levels[1]), intern = TRUE) |&gt;</div>
<div class="line">  cat(sep = &quot;\n&quot;)</div>
</div><!-- fragment --> <pre class="fragment">## Running the model...
## _________________________________________________________________________
## ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
## 
## ________________________________________________________________________________
## SIMULATION STUDY
## 
## Population size    : 20000
## Days (duration)    : 200 (of 200)
## Number of variants : 1
## Last run elapsed t : 505.00ms
## Rewiring           : off
## 
## Virus(es):
##  - Covid19 (baseline prevalence: 100 seeds)
## Tool(s):
##  - Vaccine (baseline prevalence: 25.00%)
## 
## Model parameters:
##  - Infect period         : 12.0000
##  - Latent period         : 3.0000
##  - Prob of symptoms      : 0.7000
##  - Prob of transmission  : 1.0000
##  - Prob. death           : 0.0010
##  - Prob. reinfect        : 0.1000
##  - Surveilance prob.     : 1.0e-04
##  - Vax efficacy          : 0.9000
##  - Vax redux transmision : 0.5000
## 
## Distribution of the population at time 200:
##  - Total susceptible (S)           :   19900 -&gt; 2106
##  - Total recovered (S)             :       0 -&gt; 17369
##  - Total latent (I)                :     100 -&gt; 109
##  - Total symptomatic (I)           :       0 -&gt; 155
##  - Total symptomatic isolated (I)  :       0 -&gt; 2
##  - Total asymptomatic (I)          :       0 -&gt; 72
##  - Total asymptomatic isolated (I) :       0 -&gt; 0
##  - Total removed (R)               :       0 -&gt; 187
## 
## (S): Susceptible, (I): Infected, (R): Recovered
## ________________________________________________________________________________
</pre> <div class="fragment"><div class="line">hist1 &lt;- read.csv(&quot;07-surveillance_hist.txt&quot;, sep = &quot; &quot;)</div>
<div class="line">surv1 &lt;- read.csv(&quot;07-surveillance_user_data.txt&quot;, sep = &quot; &quot;)</div>
<div class="line"> </div>
<div class="line"># With high surveillance</div>
<div class="line">system(sprintf(&quot;./07-surveillance.o %i %i 100 %.04f 2&gt;&amp;1&quot;, pop_seed, pop_size, s_levels[2]), intern = TRUE) |&gt;</div>
<div class="line">  cat(sep = &quot;\n&quot;)</div>
</div><!-- fragment --> <pre class="fragment">## Running the model...
## _________________________________________________________________________
## ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
## 
## ________________________________________________________________________________
## SIMULATION STUDY
## 
## Population size    : 20000
## Days (duration)    : 200 (of 200)
## Number of variants : 1
## Last run elapsed t : 530.00ms
## Rewiring           : off
## 
## Virus(es):
##  - Covid19 (baseline prevalence: 100 seeds)
## Tool(s):
##  - Vaccine (baseline prevalence: 25.00%)
## 
## Model parameters:
##  - Infect period         : 12.0000
##  - Latent period         : 3.0000
##  - Prob of symptoms      : 0.7000
##  - Prob of transmission  : 1.0000
##  - Prob. death           : 0.0010
##  - Prob. reinfect        : 0.1000
##  - Surveilance prob.     : 0.0020
##  - Vax efficacy          : 0.9000
##  - Vax redux transmision : 0.5000
## 
## Distribution of the population at time 200:
##  - Total susceptible (S)           :   19900 -&gt; 2125
##  - Total recovered (S)             :       0 -&gt; 17325
##  - Total latent (I)                :     100 -&gt; 109
##  - Total symptomatic (I)           :       0 -&gt; 155
##  - Total symptomatic isolated (I)  :       0 -&gt; 8
##  - Total asymptomatic (I)          :       0 -&gt; 76
##  - Total asymptomatic isolated (I) :       0 -&gt; 1
##  - Total removed (R)               :       0 -&gt; 201
## 
## (S): Susceptible, (I): Infected, (R): Recovered
## ________________________________________________________________________________
</pre> <div class="fragment"><div class="line">hist2 &lt;- read.csv(&quot;07-surveillance_hist.txt&quot;, sep = &quot; &quot;)</div>
<div class="line">surv2 &lt;- read.csv(&quot;07-surveillance_user_data.txt&quot;, sep = &quot; &quot;)</div>
<div class="line">hist_comb &lt;- rbind(</div>
<div class="line">  cbind(sim = as.character(s_levels[1]), hist1),</div>
<div class="line">  cbind(sim = as.character(s_levels[2]), hist2)</div>
<div class="line">  )</div>
</div><!-- fragment --><div class="fragment"><div class="line">ggplot(hist_comb, aes(x = date, y = counts + 1, colour = state, linetype=sim)) +</div>
<div class="line">  geom_line() +</div>
<div class="line">  # scale_y_log10() +</div>
<div class="line">  labs(y = &quot;Counts (log)&quot;)</div>
</div><!-- fragment --><p><img src="07-surveillance_files/figure-gfm/unnamed-chunk-2-1.png" alt="" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md18"></a>
Cases detected</h2>
<div class="fragment"><div class="line">survdat &lt;- rbind(</div>
<div class="line">  with(surv1, rbind(</div>
<div class="line">    data.frame(Id = as.character(s_levels[1]), Date = date, Type = &quot;N Sampled&quot;,  n = nsampled),</div>
<div class="line">    data.frame(Id = as.character(s_levels[1]), Date = date, Type = &quot;N detected&quot;,  n = ndetected),</div>
<div class="line">    data.frame(Id = as.character(s_levels[1]), Date = date, Type = &quot;N detected Asymp&quot;,  n = ndetected_asympt),</div>
<div class="line">    data.frame(Id = as.character(s_levels[1]), Date = date, Type = &quot;N Asymp&quot;,  n = nasymptomatic)</div>
<div class="line">  )),</div>
<div class="line">  with(surv2, rbind(</div>
<div class="line">    data.frame(Id = as.character(s_levels[2]), Date = date, Type = &quot;N Sampled&quot;,  n = nsampled),</div>
<div class="line">    data.frame(Id = as.character(s_levels[2]), Date = date, Type = &quot;N detected&quot;,  n = ndetected),</div>
<div class="line">    data.frame(Id = as.character(s_levels[2]), Date = date, Type = &quot;N detected Asymp&quot;,  n = ndetected_asympt),</div>
<div class="line">    data.frame(Id = as.character(s_levels[2]), Date = date, Type = &quot;N Asymp&quot;,  n = nasymptomatic)</div>
<div class="line">  ))</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">ggplot(survdat, aes(x = Date, y = n + 1, colour = Type)) +</div>
<div class="line">  geom_line() +</div>
<div class="line">  facet_wrap(~Id) +</div>
<div class="line">  scale_y_log10() +</div>
<div class="line">  labs(y = &quot;Counts (log)&quot;)</div>
</div><!-- fragment --><p><img src="07-surveillance_files/figure-gfm/unnamed-chunk-3-1.png" alt="" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
