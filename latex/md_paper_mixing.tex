George G. Vega Yon, Ph.\+D. 2024-\/04-\/25

We will look into the probability of drawing infected individuals to simplify the algorithm. There are \$I\$ infected individuals at any time in the simulation; thus, instead of drawing from \$\+Bern(c/N, N)\$, we will be drawing from \$\+Bern(c/N, I)\$. The next step is to check which infected individuals should be drawn. Letâ€™s compare the distributions using the hypergeometric as an example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{set.seed(132)}
\DoxyCodeLine{nsims <-\/ 1e5}
\DoxyCodeLine{N <-\/ 400}
\DoxyCodeLine{rate <-\/ 2}
\DoxyCodeLine{p <-\/ rate/N}
\DoxyCodeLine{I <-\/ 10}
\DoxyCodeLine{}
\DoxyCodeLine{sim\_complex <-\/ parallel::mclapply(1:nsims, \(\backslash\)(i) \{}
\DoxyCodeLine{  nsamples <-\/ rbinom(N, N, p)}
\DoxyCodeLine{  sum(rhyper(N, m = I, n = N, k = nsamples) > 0)}
\DoxyCodeLine{\}, mc.cores = 4L) |> unlist()}
\DoxyCodeLine{}
\DoxyCodeLine{sim\_simple <-\/ parallel::mclapply(1:nsims, \(\backslash\)(i) \{}
\DoxyCodeLine{  sum(rbinom(N, I, p) > 0) }
\DoxyCodeLine{\}, mc.cores = 4L) |> unlist()}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{op <-\/ par(mfrow = c(1,2))}
\DoxyCodeLine{MASS::truehist(sim\_complex)}
\DoxyCodeLine{MASS::truehist(sim\_simple)}

\end{DoxyCode}





\begin{DoxyCode}{0}
\DoxyCodeLine{par(op)}
\DoxyCodeLine{}
\DoxyCodeLine{quantile(sim\_complex)}

\end{DoxyCode}
 \begin{DoxyVerb}  0%  25%  50%  75% 100% 
   3   16   19   22   40 
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{quantile(sim\_simple)}

\end{DoxyCode}
 \begin{DoxyVerb}  0%  25%  50%  75% 100% 
   3   17   19   22   40 
\end{DoxyVerb}
 These two approaches are equivalent, but the second one is more efficient from the computational perspective. 